<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>NYC Housing Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background-color: #f8f9fa; }
    .card-img-top {
      width: 100%;
      height: auto;
      max-height: 240px;
      object-fit: contain;
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">NYC Housing Dashboard</a>
    </div>
  </nav>
  <div class="container py-4">
    <h2 class="mb-3">Explore Housing Characteristics by Borough</h2>
    <p>Select a borough to see detailed summary statistics and demographics. Use the selector below to toggle between multiple interactive choropleth maps.</p>

    <!-- Borough selection -->
    <div class="row mb-4">
      <div class="col-md-6">
        <label for="boroughSelect" class="form-label">Select a Borough</label>
        <select id="boroughSelect" class="form-select" onchange="updateBorough()">
          <option value="" disabled selected>Select a borough</option>
          <option value="Bronx">Bronx</option>
          <option value="Brooklyn">Brooklyn</option>
          <option value="Manhattan">Manhattan</option>
          <option value="Queens">Queens</option>
          <option value="Staten Island">Staten Island</option>
        </select>
      </div>
      <div class="col-md-6">
        <div id="boroughInfo" class="mt-4"></div>
      </div>
    </div>

    <!-- Map selector -->
    <div class="mb-5">
      <h3>Interactive Choropleth Map</h3>
      <div class="row mb-3">
        <div class="col-md-4">
          <label for="mapSelect" class="form-label">Select Metric</label>
          <select id="mapSelect" class="form-select" onchange="updateMap()">
            <option value="nyc_borough_folium.html" selected>Average Monthly Rent</option>
            <option value="income_choropleth.html">Average Household Income</option>
            <option value="rating_choropleth.html">Average Unit Rating</option>
            <option value="winter_util_choropleth.html">Average Winter Utilities</option>
            <option value="summer_util_choropleth.html">Average Summer Utilities</option>
            <option value="pets_choropleth.html">Average Pet Ownership</option>
            <option value="lease_choropleth.html">Average Lease Length</option>
          </select>
        </div>
      </div>
      <iframe id="mapFrame" src="nyc_borough_folium.html" width="100%" height="600" frameborder="0"></iframe>
    </div>

    <!-- Charts -->
  <!-- Charts -->
<div class="mb-5">
  <h3>Summary Charts</h3>
  <div class="row">
    <!-- Average Rent -->
    <div class="col-md-6 mb-4">
      <div class="card shadow-sm">
        <img src="rent_by_borough.png" class="card-img-top" alt="Average Rent by Borough">
        <div class="card-body">
          <h5 class="card-title">Average Rent by Borough</h5>
          <p class="card-text">This bar chart shows the average monthly rent for each borough.</p>
        </div>
      </div>
    </div>
    <!-- Average Household Income -->
    <div class="col-md-6 mb-4">
      <div class="card shadow-sm">
        <img src="income_by_borough.png" class="card-img-top" alt="Average Household Income by Borough">
        <div class="card-body">
          <h5 class="card-title">Average Household Income by Borough</h5>
          <p class="card-text">This bar chart visualises the mean household income across boroughs.</p>
        </div>
      </div>
    </div>
    <!-- Average Pet Ownership -->
    <div class="col-md-6 mb-4">
      <div class="card shadow-sm">
        <img src="pet_by_borough.png" class="card-img-top" alt="Average Pet Ownership by Borough">
        <div class="card-body">
          <h5 class="card-title">Average Pet Ownership by Borough</h5>
          <p class="card-text">Shows the average pet presence for households in each borough.</p>
        </div>
      </div>
    </div>
    <!-- Average Utility Costs (combined) -->
    <div class="col-md-6 mb-4">
      <div class="card shadow-sm">
        <img src="utilities_by_borough.png" class="card-img-top" alt="Average Utility Costs by Borough">
        <div class="card-body">
          <h5 class="card-title">Average Utility Costs by Borough</h5>
          <p class="card-text">Compares average winter and summer utility costs across boroughs.</p>
        </div>
      </div>
    </div>
    <!-- Average Summer Utility Costs -->
    <div class="col-md-6 mb-4">
      <div class="card shadow-sm">
        <img src="summer_util_by_borough.png" class="card-img-top" alt="Average Summer Utility Costs by Borough">
        <div class="card-body">
          <h5 class="card-title">Average Summer Utility Costs by Borough</h5>
          <p class="card-text">This chart shows the average summer utility cost in each borough.</p>
        </div>
      </div>
    </div>
    <!-- Average Winter Utility Costs -->
    <div class="col-md-6 mb-4">
      <div class="card shadow-sm">
        <img src="winter_util_by_borough.png" class="card-img-top" alt="Average Winter Utility Costs by Borough">
        <div class="card-body">
          <h5 class="card-title">Average Winter Utility Costs by Borough</h5>
          <p class="card-text">This chart shows the average winter utility cost in each borough.</p>
        </div>
      </div>
    </div>
    <!-- Average Lease Length -->
    <div class="col-md-6 mb-4">
      <div class="card shadow-sm">
        <img src="lease_length_by_borough.png" class="card-img-top" alt="Average Lease Length by Borough">
        <div class="card-body">
          <h5 class="card-title">Average Lease Length by Borough</h5>
          <p class="card-text">Shows the average lease duration (in months) for each borough.</p>
        </div>
      </div>
    </div>
    <!-- Average Age by Borough -->
    <div class="col-md-6 mb-4">
      <div class="card shadow-sm">
        <img src="age_by_borough.png" class="card-img-top" alt="Average Age by Borough">
        <div class="card-body">
          <h5 class="card-title">Average Age by Borough</h5>
          <p class="card-text">This bar chart displays the mean age of the main resident in each borough.</p>
        </div>
      </div>
    </div>
    <!-- Additional charts (if any) can be added similarly -->
  </div>
</div>


  <!-- Load the statistics computed by the script -->
  <script src="stats.js"></script>
  <script>
    // Display stats for selected borough
    function updateBorough() {
      const boro = document.getElementById("boroughSelect").value;
      const infoDiv = document.getElementById("boroughInfo");
      const stats = window.boroughStats || {};
      if (!stats[boro]) {
        infoDiv.innerHTML = "";
        return;
      }
      const s = stats[boro];
      let html = '<table class="table table-bordered">';
      html += '<thead><tr><th>Metric</th><th>Value</th></tr></thead><tbody>';
      html += `<tr><td>Average Rent</td><td>$${s.mean_rent.toFixed(2)}</td></tr>`;
      html += `<tr><td>Average Pets</td><td>${s.mean_pets.toFixed(2)}</td></tr>`;
      html += `<tr><td>Average Winter Utilities</td><td>$${s.mean_utilwinter.toFixed(2)}</td></tr>`;
      html += `<tr><td>Average Summer Utilities</td><td>$${s.mean_utilsummer.toFixed(2)}</td></tr>`;
      html += `<tr><td>Average Household Income</td><td>$${s.mean_income.toFixed(2)}</td></tr>`;
      html += `<tr><td>Average Unit Rating</td><td>${s.mean_rating.toFixed(2)}</td></tr>`;
      html += `<tr><td>Average Rodent Presence</td><td>${s.mean_rodents.toFixed(2)}</td></tr>`;
      html += `<tr><td>Average Housing Problems</td><td>${s.mean_probs.toFixed(2)}</td></tr>`;
      html += `<tr><td>Average Lease Length</td><td>${s.mean_lease.toFixed(2)}</td></tr>`;
      html += `<tr><td>Average Age</td><td>${s.mean_age.toFixed(2)}</td></tr>`;
      const gDist = s.gender_distribution;
      const gEntries = Object.keys(gDist).map(k => `${k}: ${(gDist[k] * 100).toFixed(1)}%`).join(", ");
      html += `<tr><td>Gender Distribution</td><td>${gEntries}</td></tr>`;
      const rDist = s.race_distribution;
      const rEntries = Object.keys(rDist).map(k => `${k}: ${(rDist[k] * 100).toFixed(1)}%`).join(", ");
      html += `<tr><td>Race Distribution</td><td>${rEntries}</td></tr>`;
      html += "</tbody></table>";
      infoDiv.innerHTML = html;
    }

    // Change map source when selecting a different metric
    function updateMap() {
      const file = document.getElementById("mapSelect").value;
      document.getElementById("mapFrame").src = file;
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
