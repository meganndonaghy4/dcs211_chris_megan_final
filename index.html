<!--
  Simple static dashboard for the NYC housing project.

  This page uses Bootstrap for layout and responsiveness and vanilla
  JavaScript to handle dropdowns for borough‑specific stats and
  comparing two boroughs side‑by‑side.  All of the charts (bar plots
  and scatter plots) are expected to be exported as PNG files from
  your Python analysis and placed in the same directory as this
  index.html file.  The Folium choropleth map is embedded via an
  iframe that points to nyc_borough_folium.html.
-->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>NYC Housing Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* Custom styles for the dashboard */
    body {
      background-color: #f8f9fa;
    }
    /* Allow chart images to maintain aspect ratio without stretching */
    .card-img-top {
      width: 100%;
      height: auto;
      max-height: 240px;
      object-fit: contain;
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">NYC Housing Dashboard</a>
    </div>
  </nav>
  <div class="container py-4">
    <h2 class="mb-3">Explore Housing Characteristics by Borough</h2>
    <p>Select a borough to see summary statistics, view interactive maps, and compare boroughs on key metrics.</p>

    <!-- Borough selector and info -->
    <div class="row mb-4">
      <div class="col-md-6">
        <label for="boroughSelect" class="form-label">Select a Borough</label>
        <select id="boroughSelect" class="form-select" onchange="updateBorough()">
          <option value="" disabled selected>Select a borough</option>
          <option value="Bronx">Bronx</option>
          <option value="Brooklyn">Brooklyn</option>
          <option value="Manhattan">Manhattan</option>
          <option value="Queens">Queens</option>
          <option value="Staten Island">Staten Island</option>
        </select>
      </div>
      <div class="col-md-6">
        <div id="boroughInfo" class="mt-4"></div>
      </div>
    </div>

    <!-- Interactive map -->
    <div class="mb-5">
      <h3>Interactive Choropleth Map</h3>
      <!-- The map generated by your Python code -->
      <iframe src="nyc_borough_folium.html" width="100%" height="600" frameborder="0"></iframe>
    </div>

    <!-- Charts section -->
    <div class="mb-5">
      <h3>Summary Charts</h3>
      <div class="row">
        <div class="col-md-6 mb-4">
          <div class="card shadow-sm">
            <img src="rent_by_borough.png" class="card-img-top" alt="Rent by Borough">
            <div class="card-body">
              <h5 class="card-title">Average Rent by Borough</h5>
              <p class="card-text">This bar chart shows the average monthly rent for each borough.</p>
            </div>
          </div>
        </div>
        <div class="col-md-6 mb-4">
          <div class="card shadow-sm">
            <img src="income_by_borough.png" class="card-img-top" alt="Income by Borough">
            <div class="card-body">
              <h5 class="card-title">Household Income by Borough</h5>
              <p class="card-text">This bar chart visualises the mean household income across boroughs.</p>
            </div>
          </div>
        </div>
        <div class="col-md-6 mb-4">
          <div class="card shadow-sm">
            <img src="pet_by_borough.png" class="card-img-top" alt="Pet Presence by Borough">
            <div class="card-body">
              <h5 class="card-title">Pet Ownership by Borough</h5>
              <p class="card-text">Shows the average pet ownership (or pet presence) for households in each borough.</p>
            </div>
          </div>
        </div>
        <div class="col-md-6 mb-4">
          <div class="card shadow-sm">
            <img src="utilities_by_borough.png" class="card-img-top" alt="Utilities by Borough">
            <div class="card-body">
              <h5 class="card-title">Utility Costs by Borough</h5>
              <p class="card-text">Compares average winter and summer utility costs across boroughs.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Compare boroughs section -->
    <div class="mb-5">
      <h3>Compare Boroughs</h3>
      <div class="row mb-3">
        <div class="col-md-5">
          <label for="compare1" class="form-label">First borough</label>
          <select id="compare1" class="form-select" onchange="updateComparison()">
            <option value="" disabled selected>Select borough</option>
            <option value="Bronx">Bronx</option>
            <option value="Brooklyn">Brooklyn</option>
            <option value="Manhattan">Manhattan</option>
            <option value="Queens">Queens</option>
            <option value="Staten Island">Staten Island</option>
          </select>
        </div>
        <div class="col-md-5">
          <label for="compare2" class="form-label">Second borough</label>
          <select id="compare2" class="form-select" onchange="updateComparison()">
            <option value="" disabled selected>Select borough</option>
            <option value="Bronx">Bronx</option>
            <option value="Brooklyn">Brooklyn</option>
            <option value="Manhattan">Manhattan</option>
            <option value="Queens">Queens</option>
            <option value="Staten Island">Staten Island</option>
          </select>
        </div>
      </div>
      <table class="table table-bordered">
        <thead class="table-light">
          <tr>
            <th scope="col">Metric</th>
            <th scope="col" id="compB1"></th>
            <th scope="col" id="compB2"></th>
          </tr>
        </thead>
        <tbody id="compTable">
          <!-- Rows will be dynamically populated based on selected boroughs -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- JavaScript section -->
  <script>
    /*
     * Rather than fetching a JSON file (which may fail when opened via the
     * file protocol), we embed the aggregated statistics directly in
     * this script.  Replace the example numbers below with the real
     * values printed by your Python script (the contents of
     * dashboard_stats.json).
     */
    const boroughStats = {
      "Bronx": {
        "mean_rent": 1450.32,
        "mean_pets": 0.28,
        "mean_utilwinter": 135.45,
        "mean_utilsummer": 105.67
      },
      "Brooklyn": {
        "mean_rent": 1820.50,
        "mean_pets": 0.31,
        "mean_utilwinter": 160.80,
        "mean_utilsummer": 120.40
      },
      "Manhattan": {
        "mean_rent": 2200.45,
        "mean_pets": 0.35,
        "mean_utilwinter": 170.15,
        "mean_utilsummer": 130.60
      },
      "Queens": {
        "mean_rent": 1750.20,
        "mean_pets": 0.30,
        "mean_utilwinter": 150.25,
        "mean_utilsummer": 110.55
      },
      "Staten Island": {
        "mean_rent": 1625.75,
        "mean_pets": 0.34,
        "mean_utilwinter": 140.00,
        "mean_utilsummer": 107.90
      }
    };

    // Update the right-hand summary when a borough is selected
    function updateBorough() {
      const boro = document.getElementById('boroughSelect').value;
      const infoDiv = document.getElementById('boroughInfo');
      if (boroughStats && boroughStats[boro]) {
        const s = boroughStats[boro];
        let html = '<table class="table table-bordered">';
        html += '<thead><tr><th>Metric</th><th>Value</th></tr></thead><tbody>';
        html += `<tr><td>Average Rent</td><td>$${s.mean_rent.toFixed(2)}</td></tr>`;
        html += `<tr><td>Average Pets</td><td>${s.mean_pets.toFixed(2)}</td></tr>`;
        html += `<tr><td>Winter Utilities</td><td>$${s.mean_utilwinter.toFixed(2)}</td></tr>`;
        html += `<tr><td>Summer Utilities</td><td>$${s.mean_utilsummer.toFixed(2)}</td></tr>`;
        html += '</tbody></table>';
        infoDiv.innerHTML = html;
      } else {
        infoDiv.innerHTML = '';
      }
    }

    // Update the comparison table when either dropdown changes
    function updateComparison() {
      const b1 = document.getElementById('compare1').value;
      const b2 = document.getElementById('compare2').value;
      const compB1 = document.getElementById('compB1');
      const compB2 = document.getElementById('compB2');
      const tableBody = document.getElementById('compTable');
      compB1.innerText = b1 || '';
      compB2.innerText = b2 || '';
      tableBody.innerHTML = '';
      if (!b1 || !b2 || !boroughStats[b1] || !boroughStats[b2]) return;
      const metrics = ['mean_rent','mean_pets','mean_utilwinter','mean_utilsummer'];
      const metricNames = {
        mean_rent: 'Average Rent ($)',
        mean_pets: 'Average Pets',
        mean_utilwinter: 'Winter Utilities ($)',
        mean_utilsummer: 'Summer Utilities ($)'
      };
      metrics.forEach(function(metric) {
        const row = document.createElement('tr');
        const cell0 = document.createElement('td');
        cell0.innerText = metricNames[metric];
        const cell1 = document.createElement('td');
        const cell2 = document.createElement('td');
        cell1.innerText = boroughStats[b1][metric].toFixed(2);
        cell2.innerText = boroughStats[b2][metric].toFixed(2);
        row.appendChild(cell0);
        row.appendChild(cell1);
        row.appendChild(cell2);
        tableBody.appendChild(row);
      });
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
